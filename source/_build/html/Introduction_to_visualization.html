

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>5. Introduction to visualization &mdash; DroneSwarmTutorial 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="6. Crazyswarm" href="Crazyswarm.html" />
    <link rel="prev" title="4. Workspace Git configuration" href="Workspace_git_configuration.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> DroneSwarmTutorial
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Prerequisites.html">2. Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="Introduction_to_MRS_Software_Extensions.html">3. Introduction to MRS Software Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Workspace_git_configuration.html">4. Workspace Git configuration</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">5. Introduction to visualization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-beginning">5.1 The beginning</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-rviz-works">5.2 How RViz works ?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#structure-of-the-visualization-brubotics-package">5.3 Structure of the visualization_brubotics package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#launch-folder">5.3.1 launch folder</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rviz-folder">5.3.2 rviz folder</a></li>
<li class="toctree-l3"><a class="reference internal" href="#data-folder">5.3.3 data folder</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scripts-folder">5.3.4 scripts folder</a></li>
<li class="toctree-l3"><a class="reference internal" href="#config-folder">5.3.5 config folder</a></li>
<li class="toctree-l3"><a class="reference internal" href="#src-folder">5.3.6 src folder</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#our-work-d-erg-visualization">5.4 Our work: D-ERG visualization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#d-erg-strategy-0">5.4.1 D-ERG strategy 0</a></li>
<li class="toctree-l3"><a class="reference internal" href="#d-erg-strategy-1">5.4.2 D-ERG strategy 1</a></li>
<li class="toctree-l3"><a class="reference internal" href="#d-erg-strategy-2">5.4.3 D-ERG strategy 2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#d-erg-strategy-3">5.4.4 D-ERG strategy 3</a></li>
<li class="toctree-l3"><a class="reference internal" href="#d-erg-strategy-4">5.4.5 D-ERG strategy 4</a></li>
<li class="toctree-l3"><a class="reference internal" href="#d-erg-strategy-5">5.4.6 D-ERG strategy 5</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Crazyswarm.html">6. Crazyswarm</a></li>
<li class="toctree-l1"><a class="reference internal" href="For_developers.html">For developers</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">DroneSwarmTutorial</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>5. Introduction to visualization</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/Introduction_to_visualization.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="introduction-to-visualization">
<h1>5. Introduction to visualization<a class="headerlink" href="#introduction-to-visualization" title="Permalink to this headline">¶</a></h1>
<p>In this chapter, we will introduce you to the visualization on Rviz. It is a great tool for ROS, used by many to debug codes or to have some nice
visualization of your simulations.</p>
<div class="section" id="the-beginning">
<h2>5.1 The beginning<a class="headerlink" href="#the-beginning" title="Permalink to this headline">¶</a></h2>
<p>First, especially if you have never runned any simulation using Rviz, we recommand you to try some CTU MRS simulation.
To do that you can run these commands:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> ~/mrs_workspace/src/simulation/example_tmux_scripts/one_drone_gps
./start.sh
</pre></div>
</div>
<p>The RViz window will open after Gazebo and it looks like this:</p>
<div class="figure align-center" id="id2">
<a class="reference internal image-reference" href="_images/one_drone_rviz.png"><img alt="_images/one_drone_rviz.png" src="_images/one_drone_rviz.png" style="width: 800px;" /></a>
<p class="caption"><span class="caption-text">Figure 5.1: RViz window with CTU visualization</span></p>
</div>
<p>You can see arrows, poses and UAV frames in this simple visualization.
For these simple tasks, you only need to click on the add button and subscribe to the topic you want to visualize.</p>
<div class="figure align-center" id="id3">
<a class="reference internal image-reference" href="_images/add_button.png"><img alt="_images/add_button.png" src="_images/add_button.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-text">Figure 5.2: Add button</span></p>
</div>
<div class="figure align-center" id="id4">
<a class="reference internal image-reference" href="_images/topic_window.png"><img alt="_images/topic_window.png" src="_images/topic_window.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-text">Figure 5.3: Topic window</span></p>
</div>
<p>You can also use the 2D Nav Goal button to choose a position and a heading to go for the UAV.</p>
<div class="figure align-center" id="id5">
<a class="reference internal image-reference" href="_images/navgoal_button.png"><img alt="_images/navgoal_button.png" src="_images/navgoal_button.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-text">Figure 5.4: Navigation goal button</span></p>
</div>
<p>Next, you can run some simulations which use dedicated plugins for one specific task.
You will need to use these commands:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> ~/mrs_workspace/src/uav_core/ros_packages/mrs_uav_testing/tmux
ls
</pre></div>
</div>
<p>It will show you the different simulation that you can test. You can do it by using <code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">./&quot;directory_of_the_simulation&quot;</span></code> and running:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>./start.sh
</pre></div>
</div>
<p>The bumper simulation is an example of advanced task that you can do on Rviz. It is made by a plugin created from scratch.
It represents a huge work to create these type of visualization but it shows you the diversity of possibilities.</p>
</div>
<div class="section" id="how-rviz-works">
<h2>5.2 How RViz works ?<a class="headerlink" href="#how-rviz-works" title="Permalink to this headline">¶</a></h2>
<p>To run a simulation, you will use the <code class="docutils literal notranslate"><span class="pre">start.sh</span></code> file wich will ask to the <code class="docutils literal notranslate"><span class="pre">session.yml</span></code> what <code class="docutils literal notranslate"><span class="pre">.launch</span></code> file are going to be runned.
A <code class="docutils literal notranslate"><span class="pre">.yml</span></code> looks like this:</p>
<div class="figure align-center" id="id6">
<a class="reference internal image-reference" href="_images/yml_file.png"><img alt="_images/yml_file.png" src="_images/yml_file.png" style="width: 800px;" /></a>
<p class="caption"><span class="caption-text">Figure 5.5: .yml file</span></p>
</div>
<p>You can see that there is an Rviz part.
The first line ask for the <code class="docutils literal notranslate"><span class="pre">rviz.launch</span></code> file which is used to choose the <code class="docutils literal notranslate"><span class="pre">.rviz</span></code> file that you want to use. This type of file is used to save
the configuration of Rviz, like what is displayed. On the <code class="docutils literal notranslate"><span class="pre">testing_brubotics</span></code> package, there is the <code class="docutils literal notranslate"><span class="pre">rviz</span></code> directory which contains all the <code class="docutils literal notranslate"><span class="pre">.rviz</span></code>
files.</p>
<p>You can generate a <code class="docutils literal notranslate"><span class="pre">.rviz</span></code> file, which save your RViz configuration, by clicking in RViz on <code class="docutils literal notranslate"><span class="pre">File-&gt;Save</span> <span class="pre">config</span> <span class="pre">as</span></code>.</p>
</div>
<div class="section" id="structure-of-the-visualization-brubotics-package">
<h2>5.3 Structure of the visualization_brubotics package<a class="headerlink" href="#structure-of-the-visualization-brubotics-package" title="Permalink to this headline">¶</a></h2>
<p>We have developed a <a class="reference external" href="https://github.com/mrs-brubotics/visualization_brubotics">visualization package</a> which permits to visualize on RViz the previous
strategies in the <a class="reference external" href="https://github.com/mrs-brubotics/testing_brubotics/tree/master/tmux_scripts/bryan/2_two_drones_D-ERG">2_two_drones_D-ERG simulation</a>.
This package is based on the <a class="reference external" href="https://github.com/ctu-mrs/mrs_rviz_plugins">mrs_rviz_plugins</a> structure. We will explain you how to reproduce it.</p>
<p>First, create a new package in <code class="docutils literal notranslate"><span class="pre">workspace/src_droneswarm_brubotics/ros_packages</span></code> with:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>catkin_create_pkg visualization_brubotics
</pre></div>
</div>
<p>This command creates a <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> file and a <code class="docutils literal notranslate"><span class="pre">package.xml</span></code> file.</p>
<p>Then, go to the <code class="docutils literal notranslate"><span class="pre">session.yml</span></code> file of the <a class="reference external" href="https://github.com/mrs-brubotics/testing_brubotics/tree/master/tmux_scripts/bryan/2_two_drones_D-ERG">2_two_drones_D-ERG simulation</a>.
At the end (line 223), you should see a RViz part. If it is commented, uncomment it. Modify these lines so it looks lite this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">rviz</span><span class="p">:</span>
   <span class="n">layout</span><span class="p">:</span> <span class="n">tiled</span>
   <span class="n">panes</span><span class="p">:</span>
     <span class="o">-</span> <span class="n">waitForControl</span><span class="p">;</span> <span class="n">roslaunch</span> <span class="n">visualization_brubotics</span> <span class="n">rviz</span><span class="o">.</span><span class="n">launch</span> <span class="n">name</span><span class="p">:</span><span class="o">=</span><span class="n">avoidance_test</span>
     <span class="o">-</span> <span class="n">waitForControl</span><span class="p">;</span> <span class="n">roslaunch</span> <span class="n">visualization_brubotics</span> <span class="n">load_robot</span><span class="o">.</span><span class="n">launch</span>
</pre></div>
</div>
<div class="section" id="launch-folder">
<h3>5.3.1 <a class="reference external" href="https://github.com/mrs-brubotics/visualization_brubotics/tree/main/launch">launch folder</a><a class="headerlink" href="#launch-folder" title="Permalink to this headline">¶</a></h3>
<p>Now, create a <code class="docutils literal notranslate"><span class="pre">launch</span></code> folder in your <code class="docutils literal notranslate"><span class="pre">visualization_brubotics</span></code> package and copy/paste the <code class="docutils literal notranslate"><span class="pre">mrs_uav_testing/launch/rviz.launch</span></code> file.
Open it and change <code class="docutils literal notranslate"><span class="pre">mrs_uav_testing</span></code> by <code class="docutils literal notranslate"><span class="pre">visualization_brubotics</span></code>. This file permits to open a RViz window when you will start the <a class="reference external" href="https://github.com/mrs-brubotics/testing_brubotics/tree/master/tmux_scripts/bryan/2_two_drones_D-ERG">2_two_drones_D-ERG simulation</a>.</p>
<p>Copy/paste the <code class="docutils literal notranslate"><span class="pre">mrs_uav_testing/launch/tf_connector_avoidance.launch</span></code> file in your <code class="docutils literal notranslate"><span class="pre">launch</span></code> folder and rename it <code class="docutils literal notranslate"><span class="pre">load_robot.launch</span></code>. Open it and make the
following changes:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;launch&gt;</span>

  <span class="nt">&lt;arg</span> <span class="na">name=</span><span class="s">&quot;uav_type&quot;</span> <span class="na">default=</span><span class="s">&quot;$(optenv UAV_TYPE f450)&quot;</span><span class="nt">/&gt;</span>

      <span class="c">&lt;!-- other args --&gt;</span>
  <span class="nt">&lt;arg</span> <span class="na">name=</span><span class="s">&quot;standalone&quot;</span> <span class="na">default=</span><span class="s">&quot;true&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;arg</span> <span class="na">name=</span><span class="s">&quot;debug&quot;</span> <span class="na">default=</span><span class="s">&quot;false&quot;</span> <span class="nt">/&gt;</span>

  <span class="nt">&lt;arg</span>     <span class="na">if=</span><span class="s">&quot;$(eval arg(&#39;standalone&#39;) or arg(&#39;debug&#39;))&quot;</span> <span class="na">name=</span><span class="s">&quot;nodelet&quot;</span> <span class="na">value=</span><span class="s">&quot;standalone&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;arg</span> <span class="na">unless=</span><span class="s">&quot;$(eval arg(&#39;standalone&#39;) or arg(&#39;debug&#39;))&quot;</span> <span class="na">name=</span><span class="s">&quot;nodelet&quot;</span> <span class="na">value=</span><span class="s">&quot;load&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;arg</span>     <span class="na">if=</span><span class="s">&quot;$(eval arg(&#39;standalone&#39;) or arg(&#39;debug&#39;))&quot;</span> <span class="na">name=</span><span class="s">&quot;nodelet_manager&quot;</span> <span class="na">value=</span><span class="s">&quot;&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;arg</span> <span class="na">unless=</span><span class="s">&quot;$(eval arg(&#39;standalone&#39;) or arg(&#39;debug&#39;))&quot;</span> <span class="na">name=</span><span class="s">&quot;nodelet_manager&quot;</span> <span class="na">value=</span><span class="s">&quot;tf_connector_nodelet_manager&quot;</span> <span class="nt">/&gt;</span>

  <span class="nt">&lt;arg</span>     <span class="na">if=</span><span class="s">&quot;$(arg debug)&quot;</span> <span class="na">name=</span><span class="s">&quot;launch_prefix&quot;</span> <span class="na">value=</span><span class="s">&quot;debug_roslaunch&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;arg</span> <span class="na">unless=</span><span class="s">&quot;$(arg debug)&quot;</span> <span class="na">name=</span><span class="s">&quot;launch_prefix&quot;</span> <span class="na">value=</span><span class="s">&quot;&quot;</span> <span class="nt">/&gt;</span>

  <span class="nt">&lt;group</span> <span class="na">ns=</span><span class="s">&quot;uav1&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&quot;robot_model&quot;</span> <span class="na">command=</span><span class="s">&quot;$(find visualization_brubotics)/scripts/generate_robot_model_xml.py $(find visualization_brubotics)/data/$(arg uav_type).xml uav1/fcu $(find visualization_brubotics)&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;node</span> <span class="na">name=</span><span class="s">&quot;tf_published_uav_marker_link&quot;</span> <span class="na">pkg=</span><span class="s">&quot;tf2_ros&quot;</span> <span class="na">type=</span><span class="s">&quot;static_transform_publisher&quot;</span> <span class="na">args=</span><span class="s">&quot;0 0 0 0 0 0 uav1/fcu uav1/fcu/uav_marker&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;node</span> <span class="na">name=</span><span class="s">&quot;tf_published_props_link&quot;</span> <span class="na">pkg=</span><span class="s">&quot;tf2_ros&quot;</span> <span class="na">type=</span><span class="s">&quot;static_transform_publisher&quot;</span> <span class="na">args=</span><span class="s">&quot;0 0 0 0 0 0 uav1/fcu uav1/fcu/props&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;node</span> <span class="na">name=</span><span class="s">&quot;tf_published_arms_link&quot;</span> <span class="na">pkg=</span><span class="s">&quot;tf2_ros&quot;</span> <span class="na">type=</span><span class="s">&quot;static_transform_publisher&quot;</span> <span class="na">args=</span><span class="s">&quot;0 0 0 0 0 0 uav1/fcu uav1/fcu/arms&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;node</span> <span class="na">name=</span><span class="s">&quot;tf_published_arms_red_link&quot;</span> <span class="na">pkg=</span><span class="s">&quot;tf2_ros&quot;</span> <span class="na">type=</span><span class="s">&quot;static_transform_publisher&quot;</span> <span class="na">args=</span><span class="s">&quot;0 0 0 0 0 0 uav1/fcu uav1/fcu/arms_red&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/group&gt;</span>

  <span class="nt">&lt;group</span> <span class="na">ns=</span><span class="s">&quot;uav2&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">&quot;robot_model&quot;</span> <span class="na">command=</span><span class="s">&quot;$(find visualization_brubotics)/scripts/generate_robot_model_xml.py $(find visualization_brubotics)/data/$(arg uav_type).xml uav2/fcu $(find visualization_brubotics)&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;node</span> <span class="na">name=</span><span class="s">&quot;tf_published_uav_marker_link&quot;</span> <span class="na">pkg=</span><span class="s">&quot;tf2_ros&quot;</span> <span class="na">type=</span><span class="s">&quot;static_transform_publisher&quot;</span> <span class="na">args=</span><span class="s">&quot;0 0 0 0 0 0 uav2/fcu uav2/fcu/uav_marker&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;node</span> <span class="na">name=</span><span class="s">&quot;tf_published_props_link&quot;</span> <span class="na">pkg=</span><span class="s">&quot;tf2_ros&quot;</span> <span class="na">type=</span><span class="s">&quot;static_transform_publisher&quot;</span> <span class="na">args=</span><span class="s">&quot;0 0 0 0 0 0 uav2/fcu uav2/fcu/props&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;node</span> <span class="na">name=</span><span class="s">&quot;tf_published_arms_link&quot;</span> <span class="na">pkg=</span><span class="s">&quot;tf2_ros&quot;</span> <span class="na">type=</span><span class="s">&quot;static_transform_publisher&quot;</span> <span class="na">args=</span><span class="s">&quot;0 0 0 0 0 0 uav2/fcu uav2/fcu/arms&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;node</span> <span class="na">name=</span><span class="s">&quot;tf_published_arms_red_link&quot;</span> <span class="na">pkg=</span><span class="s">&quot;tf2_ros&quot;</span> <span class="na">type=</span><span class="s">&quot;static_transform_publisher&quot;</span> <span class="na">args=</span><span class="s">&quot;0 0 0 0 0 0 uav2/fcu uav2/fcu/arms_red&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/group&gt;</span>

  <span class="nt">&lt;node</span> <span class="na">pkg=</span><span class="s">&quot;nodelet&quot;</span> <span class="na">type=</span><span class="s">&quot;nodelet&quot;</span> <span class="na">name=</span><span class="s">&quot;tf_connector_dummy&quot;</span> <span class="na">args=</span><span class="s">&quot;$(arg nodelet) mrs_uav_odometry/TFConnectorDummy $(arg nodelet_manager)&quot;</span> <span class="na">output=</span><span class="s">&quot;screen&quot;</span> <span class="na">launch-prefix=</span><span class="s">&quot;$(arg launch_prefix)&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;rosparam</span> <span class="na">file=</span><span class="s">&quot;$(find visualization_brubotics)/config/tf_connector_avoidance.yaml&quot;</span> <span class="nt">/&gt;</span>

    <span class="c">&lt;!-- Subscribers --&gt;</span>
    <span class="nt">&lt;remap</span> <span class="na">from=</span><span class="s">&quot;~tf_in&quot;</span> <span class="na">to=</span><span class="s">&quot;/tf&quot;</span> <span class="nt">/&gt;</span>

    <span class="c">&lt;!-- Publishers --&gt;</span>
    <span class="nt">&lt;remap</span> <span class="na">from=</span><span class="s">&quot;~tf_out&quot;</span> <span class="na">to=</span><span class="s">&quot;/tf&quot;</span> <span class="nt">/&gt;</span>

  <span class="nt">&lt;/node&gt;</span>

<span class="nt">&lt;/launch&gt;</span>
</pre></div>
</div>
<p>This file will launch the 2 UAV on the RViz window.</p>
<p>Go in the <code class="docutils literal notranslate"><span class="pre">launch</span></code> folder from <code class="docutils literal notranslate"><span class="pre">mrs_rviz_plugins</span></code>, copy the <code class="docutils literal notranslate"><span class="pre">rviz_interface</span></code> folder and paste it in your <code class="docutils literal notranslate"><span class="pre">visualization_brubotics/launch</span></code>
folder. You will be able to use tools developed by CTU like the “2D Nav Goal” after you did <a class="reference internal" href="#src-folder"><span class="std std-ref">these steps</span></a>.</p>
</div>
<div class="section" id="rviz-folder">
<h3>5.3.2 <a class="reference external" href="https://github.com/mrs-brubotics/visualization_brubotics/tree/main/rviz">rviz folder</a><a class="headerlink" href="#rviz-folder" title="Permalink to this headline">¶</a></h3>
<p>Create a <code class="docutils literal notranslate"><span class="pre">rviz</span></code> folder in your <code class="docutils literal notranslate"><span class="pre">visualization_brubotics</span></code> package. Copy/paste the <code class="docutils literal notranslate"><span class="pre">mrs_uav_testing/rviz/default_simulation.rviz</span></code> in it.
Create a <code class="docutils literal notranslate"><span class="pre">avoidance_test.rviz</span> <span class="pre">file</span></code>, copy the text from <a class="reference external" href="https://github.com/mrs-brubotics/visualization_brubotics/blob/main/rviz/avoidance_test.rviz">our existing file</a>
and paste it in the file you just have created. It will allow you to directly see on RViz what is interesting to visualize.</p>
</div>
<div class="section" id="data-folder">
<h3>5.3.3 <a class="reference external" href="https://github.com/mrs-brubotics/visualization_brubotics/tree/main/data">data folder</a><a class="headerlink" href="#data-folder" title="Permalink to this headline">¶</a></h3>
<p>For this step, you only have to copy/paste the entire <code class="docutils literal notranslate"><span class="pre">mrs_rviz_plugins/data</span></code> folder in your <code class="docutils literal notranslate"><span class="pre">visualization_brubotics</span></code> package. This folder contains the
description of the UAV models.</p>
</div>
<div class="section" id="scripts-folder">
<h3>5.3.4 <a class="reference external" href="https://github.com/mrs-brubotics/visualization_brubotics/tree/main/scripts">scripts folder</a><a class="headerlink" href="#scripts-folder" title="Permalink to this headline">¶</a></h3>
<p>Create a <code class="docutils literal notranslate"><span class="pre">scripts</span></code> folder in your <code class="docutils literal notranslate"><span class="pre">visualization_brubotics</span></code> package and copy/paste the <code class="docutils literal notranslate"><span class="pre">mrs_rviz_plugins/scripts/generate_robot_model_xml.py</span></code> file in it.
This script will generate a <code class="docutils literal notranslate"><span class="pre">robot_model</span></code> that you will be able to visualize on RViz.</p>
</div>
<div class="section" id="config-folder">
<h3>5.3.5 <a class="reference external" href="https://github.com/mrs-brubotics/visualization_brubotics/tree/main/config">config folder</a><a class="headerlink" href="#config-folder" title="Permalink to this headline">¶</a></h3>
<p>Create a <code class="docutils literal notranslate"><span class="pre">config</span></code> folder in your <code class="docutils literal notranslate"><span class="pre">visualization_brubotics</span></code> package and copy/paste the <code class="docutils literal notranslate"><span class="pre">mrs_uav_testing/config/tf_connector_avoidance.yaml</span></code> in it.
This file will define properly the frames id.</p>
</div>
<div class="section" id="src-folder">
<span id="id1"></span><h3>5.3.6 <a class="reference external" href="https://github.com/mrs-brubotics/visualization_brubotics/tree/main/src">src folder</a><a class="headerlink" href="#src-folder" title="Permalink to this headline">¶</a></h3>
<p>Finally, create a <code class="docutils literal notranslate"><span class="pre">src</span></code> folder in your <code class="docutils literal notranslate"><span class="pre">visualization_brubotics</span></code> package and copy/paste the <code class="docutils literal notranslate"><span class="pre">mrs_rviz_plugins/src/rviz_interface</span></code> folder in it.
It contains 2 <code class="docutils literal notranslate"><span class="pre">.cpp</span></code> files which define who the CTU RViz tools work.</p>
</div>
</div>
<div class="section" id="our-work-d-erg-visualization">
<h2>5.4 Our work: D-ERG visualization<a class="headerlink" href="#our-work-d-erg-visualization" title="Permalink to this headline">¶</a></h2>
<p>We want to visualize what it is computed by the <a class="reference external" href="https://github.com/mrs-brubotics/trackers_brubotics/blob/master/src/dergbryan_tracker/dergbryan_tracker.cpp">D-ERG tracker</a> of
BruBotics, especially in the <a class="reference external" href="https://github.com/mrs-brubotics/testing_brubotics/tree/master/tmux_scripts/bryan/2_two_drones_D-ERG">2_two_drones_D-ERG simulation</a> that you can
run with these commands:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> ~workspace/src/droneswarm_brubotics/ros_packages/testing_brubotics/tmux_scripts/2_two_drones_D-ERG/
./start.sh
</pre></div>
</div>
<p>We have several D-ERG (Distributed Explicit Reference Governor) strategies to illustrate. For more advanced explanations, watch <a class="reference external" href="https://www.youtube.com/watch?v=le6WSeyTXNU">this video</a></p>
<div class="section" id="d-erg-strategy-0">
<h3>5.4.1 D-ERG strategy 0<a class="headerlink" href="#d-erg-strategy-0" title="Permalink to this headline">¶</a></h3>
<div class="figure align-center" id="id7">
<a class="reference internal image-reference" href="_images/DERG-0.png"><img alt="_images/DERG-0.png" src="_images/DERG-0.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Figure 5.6: D-ERG strategy 0</span></p>
</div>
<ul class="simple">
<li><span class="math notranslate nohighlight">\(p_{k}\)</span>: current pose of the UAV</li>
<li><span class="math notranslate nohighlight">\(p̂_{k}\)</span>: desired reference pose</li>
<li><span class="math notranslate nohighlight">\(p_{k}^{v}\)</span>: applied reference pose</li>
<li><span class="math notranslate nohighlight">\(R_{a}\)</span>: drone’s radius</li>
</ul>
<p>Communicate: <span class="math notranslate nohighlight">\(p_{k}\)</span></p>
<p>Sphere can <strong>translate</strong>.</p>
<p>In order to visualize how it works, we first need to change <code class="docutils literal notranslate"><span class="pre">data/f450.xml</span></code> file. The error sphere has a constant radius so it is easy: you just need to add a marker like this:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;link</span> <span class="na">name=</span><span class="s">&quot;[REPLACEME]uav_name[/REPLACEME]/uav_marker&quot;</span><span class="nt">&gt;</span>
  <span class="c">&lt;!-- UAV specific-color marker --&gt;</span>
  <span class="nt">&lt;visual&gt;</span>
    <span class="nt">&lt;origin</span> <span class="na">xyz=</span><span class="s">&quot;0 0 -70e-3&quot;</span> <span class="na">rpy=</span><span class="s">&quot;0 0 0&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;geometry&gt;</span>
      <span class="nt">&lt;cylinder</span> <span class="na">radius=</span><span class="s">&quot;370e-3&quot;</span> <span class="na">length=</span><span class="s">&quot;220e-3&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/geometry&gt;</span>
    <span class="nt">&lt;material</span> <span class="na">name=</span><span class="s">&quot;UAVSpecificColor&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/visual&gt;</span>
  <span class="nt">&lt;visual&gt;</span>
    <span class="nt">&lt;origin</span> <span class="na">xyz=</span><span class="s">&quot;0 0 -70e-3&quot;</span> <span class="na">rpy=</span><span class="s">&quot;0 0 0&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;geometry&gt;</span>
      <span class="nt">&lt;sphere</span> <span class="na">radius=</span><span class="s">&quot;1.5&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/geometry&gt;</span>
    <span class="nt">&lt;material</span> <span class="na">name=</span><span class="s">&quot;UAVSpecificColor&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/visual&gt;</span>
</pre></div>
</div>
<p><span class="raw-html"><font color="RoyalBlue">[TODO: explanations about how to visualize the path, the applied pose and desired reference pose]JV</font></span></p>
</div>
<div class="section" id="d-erg-strategy-1">
<h3>5.4.2 D-ERG strategy 1<a class="headerlink" href="#d-erg-strategy-1" title="Permalink to this headline">¶</a></h3>
<div class="figure align-center" id="id8">
<a class="reference internal image-reference" href="_images/DERG-1.png"><img alt="_images/DERG-1.png" src="_images/DERG-1.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Figure 5.7: D-ERG strategy 1</span></p>
</div>
<p>Communicate: <span class="math notranslate nohighlight">\(p_{k}\)</span>, <span class="math notranslate nohighlight">\(p_{k}^{v}\)</span></p>
<p>Tube can <strong>translate</strong> and <strong>rotate</strong>.</p>
<p>To visualize a pill, we need to create a plugin because this display type is not available on RViz. But this is not trivial at all.</p>
<p><span class="raw-html"><font color="RoyalBlue">[TODO: explanations about how to do it]JV</font></span></p>
</div>
<div class="section" id="d-erg-strategy-2">
<h3>5.4.3 D-ERG strategy 2<a class="headerlink" href="#d-erg-strategy-2" title="Permalink to this headline">¶</a></h3>
<div class="figure align-center" id="id9">
<a class="reference internal image-reference" href="_images/DERG-2.png"><img alt="_images/DERG-2.png" src="_images/DERG-2.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Figure 5.8: D-ERG strategy 2</span></p>
</div>
<p>Communicate: <span class="math notranslate nohighlight">\(p_{k}\)</span>, <span class="math notranslate nohighlight">\(p_{k}^{v}\)</span></p>
<p>Tube can <strong>translate</strong>, <strong>rotate</strong> and <strong>change length</strong>.</p>
<p><span class="raw-html"><font color="RoyalBlue">[TODO: explanations about how to do it]JV</font></span></p>
</div>
<div class="section" id="d-erg-strategy-3">
<h3>5.4.4 D-ERG strategy 3<a class="headerlink" href="#d-erg-strategy-3" title="Permalink to this headline">¶</a></h3>
<div class="figure align-center" id="id10">
<a class="reference internal image-reference" href="_images/DERG-3.png"><img alt="_images/DERG-3.png" src="_images/DERG-3.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Figure 5.9: D-ERG strategy 3</span></p>
</div>
<p>Communicate: <span class="math notranslate nohighlight">\(p_{k}\)</span>, <span class="math notranslate nohighlight">\(p_{k}^{v}\)</span>, <span class="math notranslate nohighlight">\(S_{a,min}^{⊥}\)</span></p>
<p>Tube can <strong>translate</strong>, <strong>rotate</strong>, <strong>change length and width</strong>. The witfh (radius) is the minimal one for a tube with error directed longitudinal axis.</p>
<p><span class="raw-html"><font color="RoyalBlue">[TODO: explanations about how to do it]JV</font></span></p>
</div>
<div class="section" id="d-erg-strategy-4">
<h3>5.4.5 D-ERG strategy 4<a class="headerlink" href="#d-erg-strategy-4" title="Permalink to this headline">¶</a></h3>
<div class="figure align-center" id="id11">
<a class="reference internal image-reference" href="_images/DERG-4.png"><img alt="_images/DERG-4.png" src="_images/DERG-4.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Figure 5.10: D-ERG strategy 4</span></p>
</div>
<p>Communicate: <span class="math notranslate nohighlight">\(p_{k}^{0}\)</span>, <span class="math notranslate nohighlight">\(p_{k}^{1}\)</span>, <span class="math notranslate nohighlight">\(S_{a,min}^{⊥}\)</span></p>
<p>Tube and cylinder can <strong>translate</strong>, <strong>rotate</strong>, <strong>change length and width</strong>. The width (radius) and the length are the minimal one for a tube with error directed
longitudinal axis.</p>
<p><span class="raw-html"><font color="RoyalBlue">[TODO: explanations about how to do it]JV</font></span></p>
</div>
<div class="section" id="d-erg-strategy-5">
<h3>5.4.6 D-ERG strategy 5<a class="headerlink" href="#d-erg-strategy-5" title="Permalink to this headline">¶</a></h3>
<div class="figure align-center" id="id12">
<a class="reference internal image-reference" href="_images/DERG-5.png"><img alt="_images/DERG-5.png" src="_images/DERG-5.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Figure 5.11: D-ERG strategy 5</span></p>
</div>
<p>This final strategy permits to calculate the minimal distance between 2 drones.</p>
<p><span class="raw-html"><font color="RoyalBlue">[TODO: explanations about how to do it]JV</font></span></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="Crazyswarm.html" class="btn btn-neutral float-right" title="6. Crazyswarm" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="Workspace_git_configuration.html" class="btn btn-neutral float-left" title="4. Workspace Git configuration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, BruBotics.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>